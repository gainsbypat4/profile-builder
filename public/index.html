<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile Builder Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://unpkg.com/docx@8.2.0/build/index.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    .highlight-box { background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); }
    @media print {
      .no-print { display: none !important; }
    }
  </style>
  <script>
    if (typeof pdfjsLib !== 'undefined') {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    }
  </script>
</head>
<body class="bg-gray-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef } = React;

    // Hospital Database
    const HOSPITALS = {
      "tampa general hospital": { name: "Tampa General Hospital", beds: 1041, trauma: "Level I", emr: "Epic", teaching: true },
      "cleveland clinic": { name: "Cleveland Clinic", beds: 1400, trauma: "Level I", emr: "Epic", teaching: true },
      "baptist hospital of miami": { name: "Baptist Hospital of Miami", beds: 728, trauma: "Level II", emr: "Epic", teaching: true },
      "jackson memorial hospital": { name: "Jackson Memorial Hospital", beds: 1550, trauma: "Level I", emr: "Epic", teaching: true },
      "johns hopkins hospital": { name: "Johns Hopkins Hospital", beds: 1162, trauma: "Level I", emr: "Epic", teaching: true },
      "mayo clinic": { name: "Mayo Clinic", beds: 2059, trauma: "Level I", emr: "Epic", teaching: true },
      "massachusetts general hospital": { name: "Mass General Hospital", beds: 1057, trauma: "Level I", emr: "Epic", teaching: true },
      "mount sinai hospital": { name: "Mount Sinai Hospital", beds: 1139, trauma: "Level I", emr: "Epic", teaching: true },
      "nyu langone": { name: "NYU Langone Medical Center", beds: 834, trauma: "Level I", emr: "Epic", teaching: true },
      "adventhealth orlando": { name: "AdventHealth Orlando", beds: 1368, trauma: "Level I", emr: "Cerner", teaching: true }
    };

    function findHospital(name) {
      if (!name) return null;
      const search = name.toLowerCase();
      for (const [key, data] of Object.entries(HOSPITALS)) {
        if (search.includes(key) || key.includes(search)) return data;
      }
      return null;
    }

    async function extractPDF(file) {
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        let text = '';
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const content = await page.getTextContent();
          text += content.items.map(item => item.str).join(' ') + '\n';
        }
        return text;
      } catch (err) {
        throw new Error('Failed to read PDF file');
      }
    }

    async function extractDOCX(file) {
      try {
        const arrayBuffer = await file.arrayBuffer();
        const result = await mammoth.extractRawText({ arrayBuffer });
        return result.value;
      } catch (err) {
        throw new Error('Failed to read Word file');
      }
    }

    // Generate DOCX export
    async function exportDOCX(data, companyName, additional) {
      const { Document, Packer, Paragraph, TextRun, BorderStyle, ShadingType, AlignmentType } = docx;
      const children = [];
      
      if (companyName) {
        children.push(new Paragraph({
          children: [new TextRun({ text: companyName, bold: true, size: 24, color: "0284c7" })],
          spacing: { after: 150 }
        }));
      }
      
      children.push(new Paragraph({
        children: [new TextRun({ text: data.personalInfo?.fullName || 'Candidate', bold: true, size: 40 })],
        spacing: { after: 80 }
      }));
      
      const contact = [data.personalInfo?.email, data.personalInfo?.phone, data.personalInfo?.location].filter(Boolean).join(' | ');
      if (contact) {
        children.push(new Paragraph({
          children: [new TextRun({ text: contact, size: 20, color: "666666" })],
          spacing: { after: 200 }
        }));
      }
      
      // Quick stats line
      const stats = [];
      if (data.yearsExperience) stats.push(data.yearsExperience + ' Years Exp');
      if (data.licenses?.length) {
        const states = data.licenses.map(l => l.state).filter(Boolean).join(', ');
        const compact = data.licenses.some(l => l.compact) ? ' (Compact)' : '';
        if (states) stats.push('Licensed: ' + states + compact);
      }
      if (data.primarySpecialty) stats.push(data.primarySpecialty);
      
      if (stats.length) {
        children.push(new Paragraph({
          shading: { fill: "E0F2FE", type: ShadingType.CLEAR },
          children: [new TextRun({ text: stats.join('  •  '), bold: true, size: 20 })],
          spacing: { before: 80, after: 80 }
        }));
      }
      
      // Certifications inline
      if (data.certifications?.length) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Certs: ' + data.certifications.join(', '), size: 18 })],
          spacing: { after: 200 }
        }));
      }
      
      // Credentials header
      children.push(new Paragraph({
        children: [new TextRun({ text: 'CREDENTIALS', bold: true, size: 22, color: "0284c7" })],
        spacing: { before: 150, after: 100 },
        border: { bottom: { color: "E5E7EB", size: 1, style: BorderStyle.SINGLE } }
      }));
      
      // Licenses inline
      if (data.licenses?.length) {
        const licText = data.licenses.map(l => l.state + ' ' + (l.type || 'RN') + (l.compact ? ' (Compact)' : '')).join(' | ');
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Licenses: ' + licText, size: 18 })],
          spacing: { after: 60 }
        }));
      }
      
      // Education inline
      if (data.education) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Education: ' + data.education.degree + ', ' + data.education.school + (data.education.graduationDate ? ' (' + data.education.graduationDate + ')' : ''), size: 18 })],
          spacing: { after: 60 }
        }));
      }
      
      // Additional info
      if (additional?.nursysLink) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Nursys: ' + additional.nursysLink, size: 16, color: "0284c7" })],
          spacing: { after: 60 }
        }));
      }
      if (additional?.driversLicense?.state) {
        children.push(new Paragraph({
          children: [new TextRun({ text: "DL: " + additional.driversLicense.state + ' (Exp: ' + (additional.driversLicense.expiration || 'N/A') + ')', size: 16 })],
          spacing: { after: 100 }
        }));
      }
      
      // Work history header
      children.push(new Paragraph({
        children: [new TextRun({ text: 'WORK HISTORY', bold: true, size: 22, color: "0284c7" })],
        spacing: { before: 150, after: 100 },
        border: { bottom: { color: "E5E7EB", size: 1, style: BorderStyle.SINGLE } }
      }));
      
      // Jobs - compact format
      if (data.workHistory?.length) {
        data.workHistory.forEach(job => {
          const hospital = findHospital(job.facility);
          
          children.push(new Paragraph({
            children: [
              new TextRun({ text: job.title || 'Position', bold: true, size: 20 }),
              new TextRun({ text: ' | ' + (job.facility || ''), size: 18 }),
              new TextRun({ text: ' | ' + (job.city || '') + ', ' + (job.state || ''), size: 18, color: "666666" }),
              new TextRun({ text: ' | ' + (job.startDate || '') + ' - ' + (job.endDate || 'Present'), size: 16, italics: true, color: "888888" })
            ],
            spacing: { before: 120, after: 40 }
          }));
          
          if (job.unit) {
            children.push(new Paragraph({
              children: [new TextRun({ text: 'Unit: ' + job.unit, size: 16, color: "0284c7" })],
              spacing: { after: 40 }
            }));
          }
          
          if (hospital) {
            children.push(new Paragraph({
              children: [new TextRun({ text: '→ ' + hospital.beds + ' beds | ' + hospital.trauma + ' | ' + hospital.emr, size: 16, color: "92400E" })],
              spacing: { after: 40 }
            }));
          }
          
          if (job.responsibilities?.length) {
            const respText = job.responsibilities.slice(0, 3).join(' • ');
            children.push(new Paragraph({
              children: [new TextRun({ text: respText, size: 16 })],
              spacing: { after: 40 }
            }));
          }
          
          if (job.chargeExperience) {
            children.push(new Paragraph({
              children: [new TextRun({ text: '★ Charge Nurse Experience', bold: true, size: 16, color: "7C3AED" })],
              spacing: { after: 60 }
            }));
          }
        });
      }
      
      // References - compact
      const refs = additional?.references?.filter(r => r.name) || [];
      if (refs.length) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'REFERENCES', bold: true, size: 22, color: "0284c7" })],
          spacing: { before: 150, after: 100 },
          border: { bottom: { color: "E5E7EB", size: 1, style: BorderStyle.SINGLE } }
        }));
        
        refs.forEach(ref => {
          const refLine = [ref.name, ref.title, ref.relationship, ref.phone, ref.email].filter(Boolean).join(' | ');
          children.push(new Paragraph({
            children: [new TextRun({ text: refLine, size: 18 })],
            spacing: { after: 60 }
          }));
        });
      }
      
      children.push(new Paragraph({
        children: [new TextRun({ text: 'Generated by Profile Builder Pro • ' + new Date().toLocaleDateString(), size: 14, color: "999999" })],
        spacing: { before: 200 },
        alignment: AlignmentType.CENTER
      }));
      
      const doc = new Document({
        sections: [{
          properties: { page: { margin: { top: 720, right: 720, bottom: 720, left: 720 } } },
          children
        }]
      });
      
      const blob = await Packer.toBlob(doc);
      saveAs(blob, ((data.personalInfo?.fullName || 'Candidate').replace(/\s+/g, '_')) + '_Profile.docx');
    }

    function exportPDF(element, name) {
      html2pdf().set({
        margin: 0.3,
        filename: ((name || 'Candidate').replace(/\s+/g, '_')) + '_Profile.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      }).from(element).save();
    }

    function App() {
      const [resumeText, setResumeText] = useState('');
      const [loading, setLoading] = useState(false);
      const [fileLoading, setFileLoading] = useState(false);
      const [error, setError] = useState('');
      const [profile, setProfile] = useState(null);
      const [companyName, setCompanyName] = useState('');
      const [companyLogo, setCompanyLogo] = useState(null);
      const [fileName, setFileName] = useState('');
      const [exporting, setExporting] = useState(false);
      
      const fileRef = useRef(null);
      const logoRef = useRef(null);
      const profileRef = useRef(null);
      
      const [additional, setAdditional] = useState({
        nursysLink: '',
        driversLicense: { state: '', number: '', expiration: '' },
        references: [
          { name: '', title: '', phone: '', email: '', relationship: '' },
          { name: '', title: '', phone: '', email: '', relationship: '' },
          { name: '', title: '', phone: '', email: '', relationship: '' }
        ]
      });

      const handleFile = async (file) => {
        if (!file) return;
        setFileLoading(true);
        setError('');
        setFileName(file.name);
        
        try {
          let text = '';
          const name = file.name.toLowerCase();
          
          if (name.endsWith('.pdf')) {
            text = await extractPDF(file);
          } else if (name.endsWith('.docx') || name.endsWith('.doc')) {
            text = await extractDOCX(file);
          } else if (name.endsWith('.txt')) {
            text = await file.text();
          } else {
            throw new Error('Please upload a PDF, DOCX, or TXT file');
          }
          
          setResumeText(text);
        } catch (err) {
          setError(err.message);
          setFileName('');
        } finally {
          setFileLoading(false);
        }
      };

      const handleExtract = async () => {
        if (!resumeText.trim()) {
          setError('Please upload a file or paste resume text');
          return;
        }
        
        setLoading(true);
        setError('');
        
        try {
          const res = await fetch('/api/extract', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ resumeText })
          });
          
          const data = await res.json();
          
          if (data.error) {
            setError(data.error);
          } else {
            if (data.workHistory) {
              data.workHistory = data.workHistory.map(job => ({
                ...job,
                hospitalData: findHospital(job.facility)
              }));
            }
            setProfile(data);
          }
        } catch (err) {
          setError('Failed to process resume. Please try again.');
        } finally {
          setLoading(false);
        }
      };

      const handleLogoUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onloadend = () => setCompanyLogo(reader.result);
          reader.readAsDataURL(file);
        }
      };

      const handleExportDOCX = async () => {
        setExporting(true);
        try {
          await exportDOCX(profile, companyName, additional);
        } catch (err) {
          alert('Export failed: ' + err.message);
        } finally {
          setExporting(false);
        }
      };

      const handleExportPDF = () => {
        setExporting(true);
        try {
          exportPDF(profileRef.current, profile?.personalInfo?.fullName);
        } catch (err) {
          alert('Export failed: ' + err.message);
        } finally {
          setTimeout(() => setExporting(false), 2000);
        }
      };

      const updateRef = (idx, field, value) => {
        setAdditional(prev => {
          const refs = [...prev.references];
          refs[idx] = { ...refs[idx], [field]: value };
          return { ...prev, references: refs };
        });
      };

      return (
        <div className="min-h-screen bg-gray-50">
          <header className="bg-white border-b sticky top-0 z-50 no-print">
            <div className="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <div className="w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center">
                  <svg className="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                </div>
                <h1 className="text-lg font-bold text-gray-800">Profile Builder Pro</h1>
              </div>
              
              {profile && (
                <div className="flex gap-2">
                  <button onClick={handleExportDOCX} disabled={exporting} className="px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50">
                    Download DOCX
                  </button>
                  <button onClick={handleExportPDF} disabled={exporting} className="px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50">
                    Download PDF
                  </button>
                </div>
              )}
            </div>
          </header>

          <main className="max-w-7xl mx-auto px-6 py-6">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              
              {/* Left Column */}
              <div className="space-y-4 no-print">
                
                {/* Company Branding */}
                <div className="bg-white rounded-xl border p-4">
                  <h2 className="text-sm font-semibold mb-3">Company Branding</h2>
                  <div className="flex gap-4">
                    <input
                      type="text"
                      value={companyName}
                      onChange={(e) => setCompanyName(e.target.value)}
                      placeholder="Company Name"
                      className="flex-1 px-3 py-2 border rounded-lg text-sm"
                    />
                    <div className="flex items-center gap-2">
                      <input type="file" ref={logoRef} onChange={handleLogoUpload} accept="image/*" className="hidden" />
                      <button onClick={() => logoRef.current?.click()} className="px-3 py-2 border rounded-lg text-sm hover:bg-gray-50">
                        {companyLogo ? 'Change Logo' : 'Add Logo'}
                      </button>
                      {companyLogo && (
                        <>
                          <img src={companyLogo} alt="Logo" className="h-8 object-contain" />
                          <button onClick={() => setCompanyLogo(null)} className="text-red-500 text-xs">✕</button>
                        </>
                      )}
                    </div>
                  </div>
                </div>

                {/* Resume Upload */}
                <div className="bg-white rounded-xl border p-4">
                  <h2 className="text-sm font-semibold mb-3">Upload Resume</h2>
                  
                  <div 
                    onClick={() => fileRef.current?.click()}
                    className="border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition mb-3"
                  >
                    <input type="file" ref={fileRef} onChange={(e) => handleFile(e.target.files[0])} accept=".pdf,.docx,.doc,.txt" className="hidden" />
                    {fileLoading ? (
                      <div className="text-blue-600 text-sm">Extracting text...</div>
                    ) : fileName ? (
                      <div>
                        <div className="text-green-600 font-medium text-sm">{fileName}</div>
                        <button onClick={(e) => { e.stopPropagation(); setFileName(''); setResumeText(''); }} className="text-xs text-red-500 mt-1">Remove</button>
                      </div>
                    ) : (
                      <div className="text-gray-500 text-sm">Drop PDF, DOCX, or TXT here</div>
                    )}
                  </div>

                  <textarea
                    value={resumeText}
                    onChange={(e) => { setResumeText(e.target.value); setFileName(''); }}
                    placeholder="Or paste resume text..."
                    className="w-full h-32 px-3 py-2 border rounded-lg text-sm resize-none"
                  />

                  {error && <div className="mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-xs">{error}</div>}

                  <button onClick={handleExtract} disabled={loading || fileLoading} className="mt-3 w-full py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm">
                    {loading ? 'Processing...' : 'Extract & Build Profile'}
                  </button>
                </div>

                {/* Additional Info */}
                {profile && (
                  <div className="bg-white rounded-xl border p-4">
                    <h2 className="text-sm font-semibold mb-3">Additional Information</h2>
                    
                    <div className="grid grid-cols-2 gap-3 mb-3">
                      <input
                        type="url"
                        value={additional.nursysLink}
                        onChange={(e) => setAdditional(prev => ({ ...prev, nursysLink: e.target.value }))}
                        placeholder="Nursys Link"
                        className="px-3 py-2 border rounded-lg text-sm"
                      />
                      <div className="flex gap-2">
                        <input
                          type="text"
                          value={additional.driversLicense.state}
                          onChange={(e) => setAdditional(prev => ({ ...prev, driversLicense: { ...prev.driversLicense, state: e.target.value }}))}
                          placeholder="DL State"
                          className="w-20 px-2 py-2 border rounded-lg text-sm"
                        />
                        <input
                          type="text"
                          value={additional.driversLicense.expiration}
                          onChange={(e) => setAdditional(prev => ({ ...prev, driversLicense: { ...prev.driversLicense, expiration: e.target.value }}))}
                          placeholder="DL Exp"
                          className="flex-1 px-2 py-2 border rounded-lg text-sm"
                        />
                      </div>
                    </div>

                    <div className="text-xs font-medium text-gray-500 mb-2">References</div>
                    {additional.references.map((ref, i) => (
                      <div key={i} className="grid grid-cols-5 gap-2 mb-2">
                        <input type="text" value={ref.name} onChange={(e) => updateRef(i, 'name', e.target.value)} placeholder="Name" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.title} onChange={(e) => updateRef(i, 'title', e.target.value)} placeholder="Title" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.phone} onChange={(e) => updateRef(i, 'phone', e.target.value)} placeholder="Phone" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.email} onChange={(e) => updateRef(i, 'email', e.target.value)} placeholder="Email" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.relationship} onChange={(e) => updateRef(i, 'relationship', e.target.value)} placeholder="Relation" className="px-2 py-1 border rounded text-xs" />
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Right Column - Profile Output */}
              <div>
                {profile ? (
                  <div ref={profileRef}>
                    <ProfileDisplay data={profile} companyName={companyName} companyLogo={companyLogo} additional={additional} />
                  </div>
                ) : (
                  <div className="bg-white rounded-xl border p-8 text-center">
                    <div className="text-gray-400 text-sm">Upload a resume to generate profile</div>
                  </div>
                )}
              </div>
            </div>
          </main>
        </div>
      );
    }

    // COMPACT Profile Display - fits on one page
    function ProfileDisplay({ data, companyName, companyLogo, additional }) {
      const { personalInfo, licenses, certifications, education, workHistory, yearsExperience, primarySpecialty } = data;
      
      // Get license states properly
      const licenseStates = licenses?.map(l => l.state).filter(Boolean).join(', ') || 'N/A';
      const hasCompact = licenses?.some(l => l.compact);

      return (
        <div className="bg-white rounded-xl border overflow-hidden text-sm">
          {/* Company Header */}
          {(companyLogo || companyName) && (
            <div className="px-4 py-2 bg-gray-50 border-b flex items-center justify-between">
              <div className="flex items-center gap-2">
                {companyLogo && <img src={companyLogo} alt="Logo" className="h-6 object-contain" />}
                {companyName && <span className="font-semibold text-gray-700 text-sm">{companyName}</span>}
              </div>
              <span className="text-xs text-gray-400">Candidate Profile</span>
            </div>
          )}

          {/* Blue Highlight Box - COMPACT */}
          <div className="highlight-box text-white p-4">
            <div className="flex justify-between items-start mb-3">
              <div>
                <h1 className="text-xl font-bold">{personalInfo?.fullName || 'Candidate'}</h1>
                <p className="text-blue-100 text-xs mt-0.5">
                  {[personalInfo?.email, personalInfo?.phone].filter(Boolean).join(' • ')}
                </p>
              </div>
              <span className="bg-white/20 px-2 py-0.5 rounded-full text-xs">{primarySpecialty || 'RN'}</span>
            </div>

            <div className="grid grid-cols-4 gap-2">
              <div className="bg-white/10 rounded-lg p-2 text-center">
                <div className="text-lg font-bold">{yearsExperience || '—'}</div>
                <div className="text-xs text-blue-100">Years</div>
              </div>
              <div className="bg-white/10 rounded-lg p-2 text-center">
                <div className="text-sm font-bold">{licenseStates}</div>
                <div className="text-xs text-blue-100">{hasCompact ? 'Compact' : 'Licensed'}</div>
              </div>
              <div className="bg-white/10 rounded-lg p-2 text-center">
                <div className="text-lg font-bold">{certifications?.length || 0}</div>
                <div className="text-xs text-blue-100">Certs</div>
              </div>
              <div className="bg-white/10 rounded-lg p-2 text-center">
                <div className="text-lg font-bold">{workHistory?.length || 0}</div>
                <div className="text-xs text-blue-100">Jobs</div>
              </div>
            </div>

            {certifications?.length > 0 && (
              <div className="flex flex-wrap gap-1 mt-3">
                {certifications.map((cert, i) => (
                  <span key={i} className="bg-white/20 px-2 py-0.5 rounded-full text-xs">{cert}</span>
                ))}
              </div>
            )}
          </div>

          {/* Credentials Section - COMPACT */}
          <div className="px-4 py-3 border-b">
            <h2 className="text-sm font-bold text-gray-800 mb-2">Credentials & Education</h2>
            <div className="grid grid-cols-3 gap-4 text-xs">
              <div>
                <div className="font-semibold text-gray-500 uppercase mb-1" style={{fontSize: '10px'}}>Licenses</div>
                {licenses?.map((lic, i) => (
                  <div key={i} className="flex items-center gap-1 mb-1">
                    <span className="w-6 h-6 bg-green-100 text-green-700 rounded flex items-center justify-center font-bold" style={{fontSize: '10px'}}>{lic.state}</span>
                    <span>{lic.type || 'RN'}{lic.compact && <span className="text-green-600 ml-1">(C)</span>}</span>
                  </div>
                ))}
                {additional?.nursysLink && (
                  <a href={additional.nursysLink} target="_blank" className="text-blue-600 block mt-1" style={{fontSize: '10px'}}>Nursys →</a>
                )}
              </div>
              <div>
                <div className="font-semibold text-gray-500 uppercase mb-1" style={{fontSize: '10px'}}>Certifications</div>
                <div className="flex flex-wrap gap-1">
                  {certifications?.map((cert, i) => (
                    <span key={i} className="bg-gray-100 text-gray-700 px-1.5 py-0.5 rounded" style={{fontSize: '10px'}}>{cert}</span>
                  ))}
                </div>
              </div>
              <div>
                <div className="font-semibold text-gray-500 uppercase mb-1" style={{fontSize: '10px'}}>Education</div>
                {education && (
                  <div>
                    <div className="font-medium">{education.degree}</div>
                    <div className="text-gray-600">{education.school}</div>
                    <div className="text-gray-500">{education.graduationDate}</div>
                  </div>
                )}
                {additional?.driversLicense?.state && (
                  <div className="mt-2 pt-2 border-t">
                    <span className="text-gray-500">DL:</span> {additional.driversLicense.state}
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Work History - COMPACT */}
          <div className="px-4 py-3">
            <h2 className="text-sm font-bold text-gray-800 mb-2">Work History</h2>
            <div className="space-y-3">
              {workHistory?.map((job, i) => (
                <div key={i} className="border rounded-lg overflow-hidden">
                  <div className="bg-gray-50 px-3 py-2 border-b flex justify-between items-start">
                    <div>
                      <div className="font-bold text-gray-800">{job.title}</div>
                      <div className="text-gray-600">{job.facility} • {job.city}, {job.state}</div>
                    </div>
                    <div className="text-right">
                      <div className="text-gray-500" style={{fontSize: '10px'}}>{job.startDate} - {job.endDate}</div>
                      {job.unit && <span className="inline-block mt-0.5 bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded" style={{fontSize: '10px'}}>{job.unit}</span>}
                    </div>
                  </div>
                  <div className="px-3 py-2">
                    {job.hospitalData && (
                      <div className="mb-2 p-1.5 bg-amber-50 border border-amber-200 rounded text-xs">
                        <span className="font-medium text-amber-700">Facility: </span>
                        {job.hospitalData.beds} beds | {job.hospitalData.trauma} | {job.hospitalData.emr}
                      </div>
                    )}
                    {job.responsibilities?.length > 0 && (
                      <div className="text-xs text-gray-700">
                        {job.responsibilities.slice(0, 3).map((resp, j) => (
                          <span key={j}>{j > 0 && ' • '}{resp}</span>
                        ))}
                      </div>
                    )}
                    {job.chargeExperience && (
                      <div className="mt-1">
                        <span className="bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded font-medium" style={{fontSize: '10px'}}>★ Charge Nurse</span>
                      </div>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* References - COMPACT */}
          {additional?.references?.some(r => r.name) && (
            <div className="px-4 py-3 bg-gray-50 border-t">
              <h2 className="text-sm font-bold text-gray-800 mb-2">References</h2>
              <div className="grid grid-cols-3 gap-2">
                {additional.references.filter(r => r.name).map((ref, i) => (
                  <div key={i} className="bg-white p-2 rounded border text-xs">
                    <div className="font-medium">{ref.name}</div>
                    {ref.title && <div className="text-gray-600">{ref.title}</div>}
                    {ref.phone && <div>{ref.phone}</div>}
                  </div>
                ))}
              </div>
            </div>
          )}

          <div className="px-4 py-2 bg-gray-50 border-t text-center">
            <p className="text-xs text-gray-400">Profile Builder Pro • {new Date().toLocaleDateString()}</p>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
