<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Healthcare Profile Builder - MVP Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://unpkg.com/docx@8.2.2/build/index.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    .animate-spin { animation: spin 1s linear infinite; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .drop-zone { transition: all 0.2s ease; }
    .drop-zone.drag-over { border-color: #3b82f6; background-color: #eff6ff; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    const UNIT_TYPES = {
      "icu": { name: "Intensive Care Unit", acuity: "Critical", typicalRatio: "1:2", skills: ["Ventilator management", "Vasoactive drips", "Hemodynamic monitoring", "CRRT"] },
      "micu": { name: "Medical ICU", acuity: "Critical", typicalRatio: "1:2", skills: ["Ventilator management", "Sepsis protocols", "DKA management"] },
      "sicu": { name: "Surgical ICU", acuity: "Critical", typicalRatio: "1:2", skills: ["Post-op monitoring", "Wound care", "Drain management"] },
      "cvicu": { name: "Cardiovascular ICU", acuity: "Critical", typicalRatio: "1:2", skills: ["CABG recovery", "Balloon pump", "Swan-Ganz monitoring"] },
      "nicu": { name: "Neonatal ICU", acuity: "Critical", typicalRatio: "1:2-3", skills: ["Premature infant care", "Phototherapy", "Neonatal ventilation"] },
      "picu": { name: "Pediatric ICU", acuity: "Critical", typicalRatio: "1:2", skills: ["Pediatric assessment", "Family-centered care", "Growth/development"] },
      "er": { name: "Emergency Room", acuity: "Variable", typicalRatio: "1:4-6", skills: ["Triage", "Trauma response", "Rapid assessment"] },
      "ed": { name: "Emergency Department", acuity: "Variable", typicalRatio: "1:4-6", skills: ["Triage", "Trauma response", "Rapid assessment"] },
      "emergency": { name: "Emergency Department", acuity: "Variable", typicalRatio: "1:4-6", skills: ["Triage", "Trauma response", "Rapid assessment"] },
      "med-surg": { name: "Medical-Surgical", acuity: "Moderate", typicalRatio: "1:5-6", skills: ["Post-op care", "Medication administration", "Patient education"] },
      "medsurg": { name: "Medical-Surgical", acuity: "Moderate", typicalRatio: "1:5-6", skills: ["Post-op care", "Medication administration", "Patient education"] },
      "telemetry": { name: "Telemetry", acuity: "Moderate-High", typicalRatio: "1:4-5", skills: ["Cardiac monitoring", "Rhythm interpretation", "Chest pain protocols"] },
      "tele": { name: "Telemetry", acuity: "Moderate-High", typicalRatio: "1:4-5", skills: ["Cardiac monitoring", "Rhythm interpretation", "Chest pain protocols"] },
      "l&d": { name: "Labor & Delivery", acuity: "Variable", typicalRatio: "1:2", skills: ["Fetal monitoring", "C-section assist", "Postpartum hemorrhage"] },
      "labor and delivery": { name: "Labor & Delivery", acuity: "Variable", typicalRatio: "1:2", skills: ["Fetal monitoring", "C-section assist", "Postpartum hemorrhage"] },
      "postpartum": { name: "Postpartum", acuity: "Low-Moderate", typicalRatio: "1:4-6", skills: ["Breastfeeding support", "Newborn assessment", "C-section recovery"] },
      "oncology": { name: "Oncology", acuity: "Moderate-High", typicalRatio: "1:4-5", skills: ["Chemotherapy administration", "Port access", "Symptom management"] },
      "or": { name: "Operating Room", acuity: "Critical", typicalRatio: "1:1", skills: ["Sterile technique", "Surgical instruments", "Anesthesia support"] },
      "pacu": { name: "Post-Anesthesia Care", acuity: "High", typicalRatio: "1:2", skills: ["Airway management", "Pain control", "PONV management"] },
      "cath lab": { name: "Cardiac Cath Lab", acuity: "High", typicalRatio: "1:1", skills: ["Sheath management", "Cardiac monitoring", "Sedation"] },
      "dialysis": { name: "Dialysis", acuity: "Moderate", typicalRatio: "1:3-4", skills: ["Hemodialysis", "Fistula care", "Fluid management"] },
      "rehab": { name: "Rehabilitation", acuity: "Low-Moderate", typicalRatio: "1:5-7", skills: ["PT/OT coordination", "ADL assistance", "Discharge planning"] },
      "psych": { name: "Psychiatric", acuity: "Variable", typicalRatio: "1:5-6", skills: ["De-escalation", "Safety monitoring", "Therapeutic communication"] },
      "stepdown": { name: "Step-Down/PCU", acuity: "High", typicalRatio: "1:3-4", skills: ["Continuous monitoring", "NIV management", "Early mobility"] },
      "pcu": { name: "Progressive Care Unit", acuity: "High", typicalRatio: "1:3-4", skills: ["Continuous monitoring", "NIV management", "Drip titration"] },
      "trauma": { name: "Trauma ICU", acuity: "Critical", typicalRatio: "1:2", skills: ["Trauma assessment", "ICP monitoring", "Massive transfusion"] }
    };

    function matchUnitType(unitOrTitle) {
      if (!unitOrTitle) return null;
      const normalized = unitOrTitle.toLowerCase();
      for (const [key, data] of Object.entries(UNIT_TYPES)) {
        if (normalized.includes(key)) return data;
      }
      return null;
    }

    async function extractTextFromPDF(file) {
      const arrayBuffer = await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
      let fullText = '';
      for (let i = 1; i <= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const textContent = await page.getTextContent();
        const pageText = textContent.items.map(item => item.str).join(' ');
        fullText += pageText + '\n';
      }
      return fullText.trim();
    }

    async function extractTextFromDocx(file) {
      const arrayBuffer = await file.arrayBuffer();
      const result = await mammoth.extractRawText({ arrayBuffer });
      return result.value.trim();
    }

    // Generate Word Document
    async function generateWordDocument(profile) {
      const { Document, Paragraph, TextRun, Table, TableRow, TableCell, WidthType, BorderStyle, AlignmentType, HeadingLevel } = docx;
      
      const children = [];
      
      // Title - Name
      children.push(
        new Paragraph({
          children: [new TextRun({ text: profile.name || "Nurse Profile", bold: true, size: 48 })],
          alignment: AlignmentType.CENTER,
          spacing: { after: 200 }
        })
      );
      
      // Contact Info
      const contactLines = [];
      if (profile.phone) contactLines.push(profile.phone);
      if (profile.email) contactLines.push(profile.email);
      if (profile.location) contactLines.push(profile.location);
      
      if (contactLines.length > 0) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: contactLines.join("  |  "), size: 22 })],
            alignment: AlignmentType.CENTER,
            spacing: { after: 400 }
          })
        );
      }
      
      // Licenses Section
      if (profile.licenses && profile.licenses.length > 0) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "LICENSES", bold: true, size: 28 })],
            spacing: { before: 300, after: 150 },
            border: { bottom: { style: BorderStyle.SINGLE, size: 1, color: "999999" } }
          })
        );
        
        profile.licenses.forEach(lic => {
          children.push(
            new Paragraph({
              children: [new TextRun({ text: "‚Ä¢ " + lic, size: 22 })],
              spacing: { after: 50 }
            })
          );
        });
        
        if (profile.compactLicense) {
          children.push(
            new Paragraph({
              children: [new TextRun({ text: "‚úì Compact/Multi-state License", bold: true, color: "2E7D32", size: 22 })],
              spacing: { after: 100 }
            })
          );
        }
      }
      
      // Certifications Section
      if (profile.certifications && profile.certifications.length > 0) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "CERTIFICATIONS", bold: true, size: 28 })],
            spacing: { before: 300, after: 150 },
            border: { bottom: { style: BorderStyle.SINGLE, size: 1, color: "999999" } }
          })
        );
        
        children.push(
          new Paragraph({
            children: [new TextRun({ text: profile.certifications.join("  ‚Ä¢  "), size: 22 })],
            spacing: { after: 100 }
          })
        );
      }
      
      // Work History Section
      if (profile.workHistory && profile.workHistory.length > 0) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "WORK EXPERIENCE", bold: true, size: 28 })],
            spacing: { before: 300, after: 150 },
            border: { bottom: { style: BorderStyle.SINGLE, size: 1, color: "999999" } }
          })
        );
        
        profile.workHistory.forEach((job, index) => {
          // Job Title
          children.push(
            new Paragraph({
              children: [new TextRun({ text: job.title || "Staff Nurse", bold: true, size: 24 })],
              spacing: { before: 200, after: 50 }
            })
          );
          
          // Facility and Dates
          children.push(
            new Paragraph({
              children: [
                new TextRun({ text: job.facility || "Healthcare Facility", italics: true, size: 22 }),
                new TextRun({ text: "  |  " + (job.dates || ""), size: 22 })
              ],
              spacing: { after: 100 }
            })
          );
          
          // Hospital Data (if enriched)
          const hospitalData = job.hospitalData || job.enrichment;
          if (hospitalData && (hospitalData.verified || hospitalData.matched)) {
            const details = [];
            if (hospitalData.beds) details.push("Beds: " + hospitalData.beds);
            if (hospitalData.traumaLevel) details.push("Trauma: " + hospitalData.traumaLevel);
            if (hospitalData.teachingHospital || hospitalData.teaching) details.push("Teaching: Yes");
            if (hospitalData.emrSystem || hospitalData.emr) details.push("EMR: " + (hospitalData.emrSystem || hospitalData.emr));
            if (hospitalData.magnetStatus) details.push("Magnet Status");
            
            if (details.length > 0) {
              children.push(
                new Paragraph({
                  children: [new TextRun({ text: details.join("  |  "), size: 20, color: "666666" })],
                  spacing: { after: 100 }
                })
              );
            }
          }
          
          // Unit Info
          const unitInfo = job.unitInfo || matchUnitType(job.unit || job.title);
          if (unitInfo) {
            children.push(
              new Paragraph({
                children: [
                  new TextRun({ text: "Unit: " + unitInfo.name, size: 20 }),
                  new TextRun({ text: "  |  Typical Ratio: " + unitInfo.typicalRatio, size: 20 }),
                  new TextRun({ text: "  |  Acuity: " + unitInfo.acuity, size: 20 })
                ],
                spacing: { after: 150 }
              })
            );
          }
        });
      }
      
      // Education
      if (profile.education) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "EDUCATION", bold: true, size: 28 })],
            spacing: { before: 300, after: 150 },
            border: { bottom: { style: BorderStyle.SINGLE, size: 1, color: "999999" } }
          })
        );
        
        children.push(
          new Paragraph({
            children: [new TextRun({ text: profile.education, size: 22 })],
            spacing: { after: 100 }
          })
        );
      }
      
      // Special Notes
      if (profile.chargeExperience) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "‚≠ê CHARGE NURSE EXPERIENCE", bold: true, size: 24, color: "B8860B" })],
            spacing: { before: 300, after: 100 }
          })
        );
      }
      
      // Years Experience
      if (profile.yearsExperience) {
        children.push(
          new Paragraph({
            children: [new TextRun({ text: "Total Years Experience: " + profile.yearsExperience, bold: true, size: 22 })],
            spacing: { before: 200, after: 100 }
          })
        );
      }
      
      // Create document
      const doc = new Document({
        sections: [{
          properties: {},
          children: children
        }]
      });
      
      // Generate and save
      const blob = await docx.Packer.toBlob(doc);
      const fileName = ((profile.name || 'nurse_profile').replace(/[^a-z0-9]/gi, '_')) + '_profile.docx';
      saveAs(blob, fileName);
    }

    function App() {
      const [step, setStep] = React.useState(1);
      const [resumeText, setResumeText] = React.useState('');
      const [extractedData, setExtractedData] = React.useState(null);
      const [enrichedProfile, setEnrichedProfile] = React.useState(null);
      const [loading, setLoading] = React.useState(false);
      const [error, setError] = React.useState('');
      const [dragOver, setDragOver] = React.useState(false);
      const [fileName, setFileName] = React.useState('');
      const [fileProcessing, setFileProcessing] = React.useState(false);
      const [downloading, setDownloading] = React.useState(false);

      const handleFile = async (file) => {
        if (!file) return;
        setFileProcessing(true);
        setError('');
        setFileName(file.name);
        
        try {
          let text = '';
          const fileType = file.name.toLowerCase();
          
          if (fileType.endsWith('.pdf')) {
            text = await extractTextFromPDF(file);
          } else if (fileType.endsWith('.docx')) {
            text = await extractTextFromDocx(file);
          } else if (fileType.endsWith('.doc')) {
            setError('Old .doc format not supported. Please save as .docx or PDF.');
            setFileProcessing(false);
            return;
          } else if (fileType.endsWith('.txt')) {
            text = await file.text();
          } else {
            setError('Please upload a PDF, Word (.docx), or text file.');
            setFileProcessing(false);
            return;
          }
          
          if (text.trim().length < 50) {
            setError('Could not extract enough text from the file. Try pasting the resume instead.');
            setFileProcessing(false);
            return;
          }
          
          setResumeText(text);
        } catch (err) {
          console.error('File processing error:', err);
          setError('Error reading file: ' + (err.message || String(err)));
        }
        setFileProcessing(false);
      };

      const handleDrop = (e) => {
        e.preventDefault();
        setDragOver(false);
        const file = e.dataTransfer.files[0];
        handleFile(file);
      };

      const handleDragOver = (e) => {
        e.preventDefault();
        setDragOver(true);
      };

      const handleDragLeave = (e) => {
        e.preventDefault();
        setDragOver(false);
      };

      const handleFileInput = (e) => {
        const file = e.target.files[0];
        handleFile(file);
      };

      const loadSample = () => {
        setFileName('');
        setResumeText(`SARAH JOHNSON, RN, BSN
Phone: (305) 555-0147
Email: sarah.johnson@email.com
Miami, FL 33130

PROFESSIONAL SUMMARY
Dedicated Registered Nurse with 6+ years of experience in critical care and med-surg environments. Compact RN license. BLS, ACLS, PALS certified.

LICENSES & CERTIFICATIONS
- Registered Nurse, Florida Board of Nursing (Active)
- Compact/Multi-state License (NLC)
- BLS (American Heart Association) - Expires 2026
- ACLS (American Heart Association) - Expires 2026
- PALS (American Heart Association) - Expires 2025

WORK EXPERIENCE

Charge Nurse - ICU
Memorial Regional Medical Center | Hollywood, FL
March 2021 - Present
- Lead 18-bed intensive care unit on night shift
- Manage ventilator patients, CRRT, and vasoactive drips
- Precept new graduate nurses and travel nurses
- Coordinate with respiratory therapy and pharmacy

Staff Nurse - Med/Surg Telemetry
Jackson Memorial Hospital | Miami, FL
June 2018 - March 2021
- Provided care for 5-6 patients on 32-bed unit
- Telemetry monitoring and rhythm interpretation
- Medication administration and patient education

EDUCATION
Bachelor of Science in Nursing (BSN)
University of Miami | 2018`);
      };

      const extractData = async () => {
        if (!resumeText.trim()) {
          setError('Please paste a resume or upload a file first');
          return;
        }
        setLoading(true);
        setError('');
        
        try {
          const response = await fetch('/api/extract', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ resumeText })
          });
          
          const responseText = await response.text();
          console.log('API Response:', responseText);
          
          let parsed;
          try {
            parsed = JSON.parse(responseText);
          } catch (parseErr) {
            console.error('JSON Parse Error:', parseErr);
            setError('Failed to parse API response. Raw response: ' + responseText.substring(0, 200));
            setLoading(false);
            return;
          }
          
          if (parsed.error) {
            setError(String(parsed.error));
            setLoading(false);
            return;
          }
          
          if (!response.ok) {
            setError('API request failed: ' + (parsed.error || parsed.message || 'Unknown error'));
            setLoading(false);
            return;
          }
          
          setExtractedData(parsed);
          
          const workHistory = Array.isArray(parsed.workHistory) ? parsed.workHistory : [];
          
          const enriched = {
            ...parsed,
            workHistory: workHistory.map(job => {
              const unitData = matchUnitType(job.unit || job.title);
              return {
                ...job,
                unitInfo: unitData
              };
            })
          };
          
          setEnrichedProfile(enriched);
          setStep(3);
        } catch (err) {
          console.error('Extract Error:', err);
          const errorMsg = err && err.message ? String(err.message) : String(err) || 'Failed to extract data. Please try again.';
          setError(errorMsg);
        } finally {
          setLoading(false);
        }
      };

      const handleDownload = async () => {
        if (!enrichedProfile) return;
        setDownloading(true);
        try {
          await generateWordDocument(enrichedProfile);
        } catch (err) {
          console.error('Download error:', err);
          setError('Failed to generate document: ' + (err.message || String(err)));
        }
        setDownloading(false);
      };

      const CheckCircle = () => (
        React.createElement('svg', { className: "w-5 h-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M5 13l4 4L19 7" })
        )
      );

      const Spinner = () => (
        React.createElement('svg', { className: "animate-spin h-5 w-5 text-white", fill: "none", viewBox: "0 0 24 24" },
          React.createElement('circle', { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }),
          React.createElement('path', { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" })
        )
      );

      const UploadIcon = () => (
        React.createElement('svg', { className: "w-12 h-12 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 1.5, d: "M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" })
        )
      );

      const FileIcon = () => (
        React.createElement('svg', { className: "w-6 h-6 text-blue-500", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })
        )
      );

      const DownloadIcon = () => (
        React.createElement('svg', { className: "w-5 h-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })
        )
      );

      return React.createElement('div', { className: "min-h-screen bg-gray-50 p-4" },
        React.createElement('div', { className: "max-w-4xl mx-auto" },
          
          // Header
          React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6 mb-6" },
            React.createElement('div', { className: "flex justify-between items-start" },
              React.createElement('div', null,
                React.createElement('h1', { className: "text-2xl font-bold text-gray-900" }, "Healthcare Profile Builder"),
                React.createElement('p', { className: "text-gray-600 mt-1" }, "AI-powered nurse profile enrichment ‚Äî MVP Demo")
              ),
              React.createElement('span', { className: "px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium" }, "‚ú® Real AI Extraction")
            ),
            
            // Progress Steps
            React.createElement('div', { className: "flex items-center mt-6" },
              [1, 2, 3].map(function(s, i) { 
                return React.createElement(React.Fragment, { key: s },
                  React.createElement('div', { 
                    className: "flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium " + (step >= s ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-500')
                  }, step > s ? React.createElement(CheckCircle) : s),
                  i < 2 ? React.createElement('div', { className: "flex-1 h-1 mx-2 " + (step > s ? 'bg-blue-600' : 'bg-gray-200') }) : null
                );
              })
            ),
            React.createElement('div', { className: "flex justify-between mt-2 text-sm text-gray-600" },
              React.createElement('span', null, "Paste Resume"),
              React.createElement('span', null, "Extract Data"),
              React.createElement('span', null, "Review Profile")
            )
          ),

          // Step 1: Input
          step === 1 ? React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
            React.createElement('h2', { className: "text-lg font-semibold mb-4 flex items-center gap-2" }, "üìÑ Upload or Paste Resume"),
            
            // File Upload Zone
            React.createElement('div', {
              className: "drop-zone border-2 border-dashed rounded-lg p-8 text-center mb-4 cursor-pointer " + (dragOver ? 'drag-over border-blue-500 bg-blue-50' : 'border-gray-300 hover:border-gray-400'),
              onDrop: handleDrop,
              onDragOver: handleDragOver,
              onDragLeave: handleDragLeave,
              onClick: function() { document.getElementById('fileInput').click(); }
            },
              React.createElement('input', {
                type: 'file',
                id: 'fileInput',
                className: 'hidden',
                accept: '.pdf,.docx,.doc,.txt',
                onChange: handleFileInput
              }),
              fileProcessing ? 
                React.createElement('div', { className: "flex flex-col items-center" },
                  React.createElement('div', { className: "animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mb-2" }),
                  React.createElement('p', { className: "text-gray-600" }, "Processing file...")
                ) :
              fileName ?
                React.createElement('div', { className: "flex flex-col items-center" },
                  React.createElement(FileIcon),
                  React.createElement('p', { className: "text-gray-900 font-medium mt-2" }, fileName),
                  React.createElement('p', { className: "text-green-600 text-sm" }, "‚úì File loaded successfully")
                ) :
                React.createElement('div', { className: "flex flex-col items-center" },
                  React.createElement(UploadIcon),
                  React.createElement('p', { className: "text-gray-600 mt-2" }, "Drag & drop a file here, or click to browse"),
                  React.createElement('p', { className: "text-gray-400 text-sm mt-1" }, "Supports PDF, Word (.docx), and text files")
                )
            ),
            
            React.createElement('div', { className: "flex items-center gap-4 mb-4" },
              React.createElement('div', { className: "flex-1 h-px bg-gray-200" }),
              React.createElement('span', { className: "text-gray-400 text-sm" }, "or paste text below"),
              React.createElement('div', { className: "flex-1 h-px bg-gray-200" })
            ),
            
            React.createElement('textarea', {
              className: "w-full h-64 p-4 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
              placeholder: "Paste resume text here...",
              value: resumeText,
              onChange: function(e) { setResumeText(e.target.value); setFileName(''); }
            }),
            
            error ? React.createElement('div', { className: "bg-red-50 border border-red-200 rounded-lg p-4 mt-4 text-red-700" }, "‚ö† " + error) : null,
            
            React.createElement('div', { className: "flex gap-3 mt-4" },
              React.createElement('button', {
                onClick: loadSample,
                className: "px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
              }, "Load Sample Resume"),
              React.createElement('button', {
                onClick: function() { setStep(2); },
                disabled: !resumeText.trim(),
                className: "px-6 py-2 rounded-lg font-medium " + (resumeText.trim() ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-200 text-gray-500 cursor-not-allowed')
              }, "Continue ‚Üí")
            )
          ) : null,

          // Step 2: Extract
          step === 2 ? React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
            React.createElement('h2', { className: "text-lg font-semibold mb-4 flex items-center gap-2" }, "üîç Extract & Enrich Profile"),
            React.createElement('div', { className: "bg-gray-50 rounded-lg p-4 mb-4 max-h-64 overflow-y-auto" },
              React.createElement('pre', { className: "whitespace-pre-wrap font-mono text-sm text-gray-700" }, resumeText)
            ),
            React.createElement('div', { className: "bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4" },
              React.createElement('h3', { className: "font-medium text-blue-900 mb-2" }, "What happens next:"),
              React.createElement('ul', { className: "text-blue-800 text-sm space-y-1" },
                React.createElement('li', null, "‚Ä¢ Claude AI extracts: Name, contact, work history, licenses, certifications"),
                React.createElement('li', null, "‚Ä¢ System enriches: Hospital beds, trauma level, EMR, teaching status"),
                React.createElement('li', null, "‚Ä¢ Auto-fills: Typical responsibilities by unit type")
              )
            ),
            error ? React.createElement('div', { className: "bg-red-50 border border-red-200 rounded-lg p-4 mb-4 text-red-700" }, "‚ö† " + error) : null,
            React.createElement('div', { className: "flex gap-3" },
              React.createElement('button', {
                onClick: function() { setStep(1); setError(''); },
                className: "px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
              }, "‚Üê Back"),
              React.createElement('button', {
                onClick: extractData,
                disabled: loading,
                className: "px-6 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2"
              }, loading ? React.createElement(Spinner) : null, loading ? "Extracting..." : "‚úì Extract & Enrich")
            )
          ) : null,

          // Step 3: Review
          step === 3 && enrichedProfile ? React.createElement('div', { className: "space-y-6" },
            // Contact Card
            React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
              React.createElement('h2', { className: "text-xl font-bold text-gray-900" }, enrichedProfile.name || "Unknown"),
              React.createElement('div', { className: "mt-2 text-gray-600 space-y-1" },
                enrichedProfile.phone ? React.createElement('p', null, "üìû " + enrichedProfile.phone) : null,
                enrichedProfile.email ? React.createElement('p', null, "‚úâÔ∏è " + enrichedProfile.email) : null,
                enrichedProfile.location ? React.createElement('p', null, "üìç " + enrichedProfile.location) : null
              )
            ),
            
            // Licenses
            enrichedProfile.licenses && enrichedProfile.licenses.length > 0 ? React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
              React.createElement('h3', { className: "font-semibold text-gray-900 mb-3" }, "ü™™ Licenses"),
              React.createElement('div', { className: "flex flex-wrap gap-2" },
                enrichedProfile.licenses.map(function(lic, i) {
                  return React.createElement('span', { key: i, className: "px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm" }, String(lic));
                })
              ),
              enrichedProfile.compactLicense ? React.createElement('p', { className: "mt-2 text-green-600 font-medium" }, "‚úì Compact/Multi-state License") : null
            ) : null,
            
            // Certifications
            enrichedProfile.certifications && enrichedProfile.certifications.length > 0 ? React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
              React.createElement('h3', { className: "font-semibold text-gray-900 mb-3" }, "üìú Certifications"),
              React.createElement('div', { className: "flex flex-wrap gap-2" },
                enrichedProfile.certifications.map(function(cert, i) {
                  return React.createElement('span', { key: i, className: "px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm" }, String(cert));
                })
              )
            ) : null,
            
            // Work History
            React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6" },
              React.createElement('h3', { className: "font-semibold text-gray-900 mb-4" }, "üíº Work History"),
              React.createElement('div', { className: "space-y-6" },
                (enrichedProfile.workHistory || []).map(function(job, i) {
                  const hospitalData = job.hospitalData || job.enrichment;
                  const isVerified = hospitalData && (hospitalData.verified || hospitalData.matched);
                  
                  return React.createElement('div', { key: i, className: "border-l-4 border-blue-500 pl-4" },
                    React.createElement('h4', { className: "font-medium text-gray-900" }, job.title || "Unknown Position"),
                    React.createElement('p', { className: "text-gray-600" }, (job.facility || "Unknown Facility") + " | " + (job.dates || "Dates not specified")),
                    
                    // Enrichment Badge
                    isVerified ? React.createElement('div', { className: "mt-2 bg-green-50 border border-green-200 rounded-lg p-3" },
                      React.createElement('p', { className: "text-green-800 font-medium text-sm" }, "‚úì Hospital Verified"),
                      React.createElement('div', { className: "grid grid-cols-2 gap-2 mt-2 text-sm" },
                        React.createElement('span', { className: "text-gray-600" }, "Beds: ", React.createElement('span', { className: "font-medium" }, hospitalData.beds || hospitalData.beds || "N/A")),
                        React.createElement('span', { className: "text-gray-600" }, "Trauma: ", React.createElement('span', { className: "font-medium" }, hospitalData.traumaLevel || hospitalData.traumaLevel || "N/A")),
                        React.createElement('span', { className: "text-gray-600" }, "Teaching: ", React.createElement('span', { className: "font-medium" }, (hospitalData.teachingHospital || hospitalData.teaching) ? "Yes" : "No")),
                        React.createElement('span', { className: "text-gray-600" }, "EMR: ", React.createElement('span', { className: "font-medium" }, hospitalData.emrSystem || hospitalData.emr || "Unknown"))
                      )
                    ) : null,
                    
                    // Unit Info
                    job.unitInfo ? React.createElement('div', { className: "mt-2 bg-blue-50 border border-blue-200 rounded-lg p-3" },
                      React.createElement('p', { className: "text-blue-800 font-medium text-sm" }, "Unit: " + job.unitInfo.name),
                      React.createElement('p', { className: "text-blue-700 text-sm" }, "Typical Ratio: " + job.unitInfo.typicalRatio + " | Acuity: " + job.unitInfo.acuity)
                    ) : null
                  );
                })
              )
            ),
            
            // Charge Nurse Experience
            enrichedProfile.chargeExperience ? React.createElement('div', { className: "bg-yellow-50 border border-yellow-200 rounded-lg p-4" },
              React.createElement('p', { className: "text-yellow-800 font-medium" }, "‚≠ê Charge Nurse Experience Detected")
            ) : null,
            
            // Actions
            React.createElement('div', { className: "flex gap-3" },
              React.createElement('button', {
                onClick: function() { setStep(1); setResumeText(''); setEnrichedProfile(null); setFileName(''); setError(''); },
                className: "px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
              }, "‚Üê Start Over"),
              React.createElement('button', {
                onClick: handleDownload,
                disabled: downloading,
                className: "px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2"
              }, 
                downloading ? React.createElement(Spinner) : React.createElement(DownloadIcon),
                downloading ? "Generating..." : "Download Profile"
              )
            )
          ) : null
        )
      );
    }

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>
