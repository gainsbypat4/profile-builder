<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile Builder Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://unpkg.com/docx@8.2.0/build/index.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    .highlight-box { background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); }
    @media print { .no-print { display: none !important; } }
  </style>
  <script>
    if (typeof pdfjsLib !== 'undefined') {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    }
  </script>
</head>
<body class="bg-gray-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef } = React;

    const HOSPITALS = {
      "tampa general hospital": { name: "Tampa General Hospital", beds: 1041, trauma: "Level I", emr: "Epic", teaching: true },
      "cleveland clinic": { name: "Cleveland Clinic", beds: 1400, trauma: "Level I", emr: "Epic", teaching: true },
      "baptist hospital of miami": { name: "Baptist Hospital of Miami", beds: 728, trauma: "Level II", emr: "Epic", teaching: true },
      "jackson memorial hospital": { name: "Jackson Memorial Hospital", beds: 1550, trauma: "Level I", emr: "Epic", teaching: true },
      "johns hopkins hospital": { name: "Johns Hopkins Hospital", beds: 1162, trauma: "Level I", emr: "Epic", teaching: true },
      "mayo clinic": { name: "Mayo Clinic", beds: 2059, trauma: "Level I", emr: "Epic", teaching: true },
      "massachusetts general hospital": { name: "Mass General Hospital", beds: 1057, trauma: "Level I", emr: "Epic", teaching: true },
      "mount sinai hospital": { name: "Mount Sinai Hospital", beds: 1139, trauma: "Level I", emr: "Epic", teaching: true },
      "nyu langone": { name: "NYU Langone Medical Center", beds: 834, trauma: "Level I", emr: "Epic", teaching: true },
      "adventhealth orlando": { name: "AdventHealth Orlando", beds: 1368, trauma: "Level I", emr: "Cerner", teaching: true }
    };

    function findHospital(name) {
      if (!name) return null;
      const search = name.toLowerCase();
      for (const [key, data] of Object.entries(HOSPITALS)) {
        if (search.includes(key) || key.includes(search)) return data;
      }
      return null;
    }

    async function extractPDF(file) {
      const arrayBuffer = await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
      let text = '';
      for (let i = 1; i <= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const content = await page.getTextContent();
        text += content.items.map(item => item.str).join(' ') + '\n';
      }
      return text;
    }

    async function extractDOCX(file) {
      const arrayBuffer = await file.arrayBuffer();
      const result = await mammoth.extractRawText({ arrayBuffer });
      return result.value;
    }

    async function exportDOCX(data, companyName, additional) {
      const { Document, Packer, Paragraph, TextRun, BorderStyle, ShadingType, AlignmentType } = docx;
      const children = [];
      
      // Company header - BIG
      if (companyName) {
        children.push(new Paragraph({
          children: [new TextRun({ text: companyName, bold: true, size: 40, color: "0284c7" })],
          spacing: { after: 80 }
        }));
        children.push(new Paragraph({
          children: [new TextRun({ text: "Candidate Profile", size: 22, color: "888888" })],
          spacing: { after: 250 }
        }));
      }
      
      // Name - VERY BIG
      children.push(new Paragraph({
        children: [new TextRun({ text: data.personalInfo?.fullName || 'Candidate', bold: true, size: 52 })],
        spacing: { after: 80 }
      }));
      
      // Contact info
      const contact = [data.personalInfo?.email, data.personalInfo?.phone, data.personalInfo?.location].filter(Boolean).join(' | ');
      if (contact) {
        children.push(new Paragraph({
          children: [new TextRun({ text: contact, size: 22, color: "666666" })],
          spacing: { after: 200 }
        }));
      }
      
      // Quick stats box
      const licenseStates = data.licenses?.map(l => l.state).filter(Boolean).join(', ') || 'N/A';
      const hasCompact = data.licenses?.some(l => l.compact);
      
      children.push(new Paragraph({
        shading: { fill: "DBEAFE", type: ShadingType.CLEAR },
        children: [
          new TextRun({ text: `${data.yearsExperience || '‚Äî'} Years Experience`, bold: true, size: 24 }),
          new TextRun({ text: "   ‚Ä¢   ", size: 24, color: "60A5FA" }),
          new TextRun({ text: `Licensed: ${licenseStates}${hasCompact ? ' (Compact)' : ''}`, bold: true, size: 24 }),
          new TextRun({ text: "   ‚Ä¢   ", size: 24, color: "60A5FA" }),
          new TextRun({ text: `${data.certifications?.length || 0} Certifications`, bold: true, size: 24 }),
          new TextRun({ text: "   ‚Ä¢   ", size: 24, color: "60A5FA" }),
          new TextRun({ text: data.primarySpecialty || 'RN', bold: true, size: 24 }),
        ],
        spacing: { before: 100, after: 150 }
      }));
      
      // Certifications
      if (data.certifications?.length) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Certifications: ' + data.certifications.join(', '), size: 22 })],
          spacing: { after: 250 }
        }));
      }
      
      // CREDENTIALS SECTION
      children.push(new Paragraph({
        children: [new TextRun({ text: 'CREDENTIALS & EDUCATION', bold: true, size: 28, color: "1E40AF" })],
        spacing: { before: 200, after: 150 },
        border: { bottom: { color: "1E40AF", size: 1, style: BorderStyle.SINGLE } }
      }));
      
      // Licenses
      if (data.licenses?.length) {
        const licText = data.licenses.map(l => `${l.state || '??'} ${l.type || 'RN'}${l.compact ? ' (Compact)' : ''}`).join('  |  ');
        children.push(new Paragraph({
          children: [
            new TextRun({ text: 'Licenses: ', bold: true, size: 24 }),
            new TextRun({ text: licText, size: 24 })
          ],
          spacing: { after: 100 }
        }));
      }
      
      // Education
      if (data.education) {
        children.push(new Paragraph({
          children: [
            new TextRun({ text: 'Education: ', bold: true, size: 24 }),
            new TextRun({ text: `${data.education.degree || ''}, ${data.education.school || ''}${data.education.graduationDate ? ' (' + data.education.graduationDate + ')' : ''}`, size: 24 })
          ],
          spacing: { after: 100 }
        }));
      }
      
      // Additional info
      if (additional?.nursysLink) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'Nursys Verification: ' + additional.nursysLink, size: 20, color: "2563EB" })],
          spacing: { after: 80 }
        }));
      }
      if (additional?.driversLicense?.state) {
        children.push(new Paragraph({
          children: [new TextRun({ text: `Driver's License: ${additional.driversLicense.state} (Exp: ${additional.driversLicense.expiration || 'N/A'})`, size: 20 })],
          spacing: { after: 150 }
        }));
      }
      
      // WORK HISTORY SECTION
      children.push(new Paragraph({
        children: [new TextRun({ text: 'WORK HISTORY', bold: true, size: 28, color: "1E40AF" })],
        spacing: { before: 250, after: 150 },
        border: { bottom: { color: "1E40AF", size: 1, style: BorderStyle.SINGLE } }
      }));
      
      if (data.workHistory?.length) {
        data.workHistory.forEach((job, idx) => {
          const hospital = findHospital(job.facility);
          
          // Job title and facility
          children.push(new Paragraph({
            children: [new TextRun({ text: job.title || 'Position', bold: true, size: 26 })],
            spacing: { before: idx > 0 ? 200 : 100, after: 50 }
          }));
          
          children.push(new Paragraph({
            children: [
              new TextRun({ text: job.facility || '', size: 24 }),
              new TextRun({ text: ` ‚Äî ${job.city || ''}, ${job.state || ''}`, size: 24, color: "666666" })
            ],
            spacing: { after: 30 }
          }));
          
          children.push(new Paragraph({
            children: [
              new TextRun({ text: `${job.startDate || ''} - ${job.endDate || 'Present'}`, size: 22, italics: true, color: "888888" }),
              job.unit ? new TextRun({ text: `   |   ${job.unit}`, size: 22, color: "2563EB" }) : new TextRun({ text: '' })
            ],
            spacing: { after: 80 }
          }));
          
          // Hospital enrichment
          if (hospital) {
            children.push(new Paragraph({
              shading: { fill: "FEF3C7", type: ShadingType.CLEAR },
              children: [new TextRun({ text: `üìç ${hospital.beds} beds  |  ${hospital.trauma}  |  ${hospital.teaching ? 'Teaching Hospital' : 'Non-Teaching'}  |  ${hospital.emr} EMR`, size: 20, color: "92400E" })],
              spacing: { after: 80 }
            }));
          }
          
          // Responsibilities - ALL of them
          if (job.responsibilities?.length) {
            job.responsibilities.forEach(resp => {
              children.push(new Paragraph({
                children: [new TextRun({ text: `‚Ä¢ ${resp}`, size: 22 })],
                spacing: { after: 40 }
              }));
            });
          }
          
          // Charge experience
          if (job.chargeExperience) {
            children.push(new Paragraph({
              children: [new TextRun({ text: '‚≠ê Charge Nurse Experience', bold: true, size: 22, color: "7C3AED" })],
              spacing: { before: 60, after: 80 }
            }));
          }
        });
      }
      
      // REFERENCES
      const refs = additional?.references?.filter(r => r.name) || [];
      if (refs.length) {
        children.push(new Paragraph({
          children: [new TextRun({ text: 'PROFESSIONAL REFERENCES', bold: true, size: 28, color: "1E40AF" })],
          spacing: { before: 250, after: 150 },
          border: { bottom: { color: "1E40AF", size: 1, style: BorderStyle.SINGLE } }
        }));
        
        refs.forEach(ref => {
          children.push(new Paragraph({
            children: [
              new TextRun({ text: ref.name, bold: true, size: 24 }),
              ref.title ? new TextRun({ text: ` ‚Äî ${ref.title}`, size: 22, color: "666666" }) : new TextRun({ text: '' })
            ],
            spacing: { before: 100, after: 30 }
          }));
          const contactParts = [ref.relationship, ref.phone, ref.email].filter(Boolean);
          if (contactParts.length) {
            children.push(new Paragraph({
              children: [new TextRun({ text: contactParts.join('  |  '), size: 22 })],
              spacing: { after: 80 }
            }));
          }
        });
      }
      
      // Footer
      children.push(new Paragraph({
        children: [new TextRun({ text: `Generated by Profile Builder Pro  ‚Ä¢  ${new Date().toLocaleDateString()}`, size: 18, color: "9CA3AF" })],
        spacing: { before: 300 },
        alignment: AlignmentType.CENTER
      }));
      
      const doc = new Document({
        sections: [{ properties: { page: { margin: { top: 720, right: 720, bottom: 720, left: 720 } } }, children }]
      });
      
      const blob = await Packer.toBlob(doc);
      saveAs(blob, `${(data.personalInfo?.fullName || 'Candidate').replace(/\s+/g, '_')}_Profile.docx`);
    }

    function exportPDF(element, name) {
      html2pdf().set({
        margin: 0.4,
        filename: `${(name || 'Candidate').replace(/\s+/g, '_')}_Profile.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      }).from(element).save();
    }

    function App() {
      const [resumeText, setResumeText] = useState('');
      const [loading, setLoading] = useState(false);
      const [fileLoading, setFileLoading] = useState(false);
      const [error, setError] = useState('');
      const [profile, setProfile] = useState(null);
      const [companyName, setCompanyName] = useState('');
      const [companyLogo, setCompanyLogo] = useState(null);
      const [fileName, setFileName] = useState('');
      const [exporting, setExporting] = useState(false);
      
      const fileRef = useRef(null);
      const logoRef = useRef(null);
      const profileRef = useRef(null);
      
      const [additional, setAdditional] = useState({
        nursysLink: '',
        driversLicense: { state: '', number: '', expiration: '' },
        references: [
          { name: '', title: '', phone: '', email: '', relationship: '' },
          { name: '', title: '', phone: '', email: '', relationship: '' },
          { name: '', title: '', phone: '', email: '', relationship: '' }
        ]
      });

      const handleFile = async (file) => {
        if (!file) return;
        setFileLoading(true);
        setError('');
        setFileName(file.name);
        try {
          let text = '';
          const name = file.name.toLowerCase();
          if (name.endsWith('.pdf')) text = await extractPDF(file);
          else if (name.endsWith('.docx') || name.endsWith('.doc')) text = await extractDOCX(file);
          else if (name.endsWith('.txt')) text = await file.text();
          else throw new Error('Please upload a PDF, DOCX, or TXT file');
          setResumeText(text);
        } catch (err) {
          setError(err.message);
          setFileName('');
        } finally {
          setFileLoading(false);
        }
      };

      const handleExtract = async () => {
        if (!resumeText.trim()) {
          setError('Please upload a file or paste resume text');
          return;
        }
        setLoading(true);
        setError('');
        try {
          const res = await fetch('/api/extract', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ resumeText })
          });
          const data = await res.json();
          if (data.error) {
            setError(data.error);
          } else {
            // Enrich work history with hospital data
            if (data.workHistory) {
              data.workHistory = data.workHistory.map(job => ({
                ...job,
                hospitalData: findHospital(job.facility)
              }));
            }
            setProfile(data);
          }
        } catch (err) {
          setError('Failed to process resume. Please try again.');
        } finally {
          setLoading(false);
        }
      };

      const handleLogoUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onloadend = () => setCompanyLogo(reader.result);
          reader.readAsDataURL(file);
        }
      };

      const handleExportDOCX = async () => {
        setExporting(true);
        try { await exportDOCX(profile, companyName, additional); }
        catch (err) { alert('Export failed: ' + err.message); }
        finally { setExporting(false); }
      };

      const handleExportPDF = () => {
        setExporting(true);
        try { exportPDF(profileRef.current, profile?.personalInfo?.fullName); }
        catch (err) { alert('Export failed: ' + err.message); }
        finally { setTimeout(() => setExporting(false), 2000); }
      };

      const updateRef = (idx, field, value) => {
        setAdditional(prev => {
          const refs = [...prev.references];
          refs[idx] = { ...refs[idx], [field]: value };
          return { ...prev, references: refs };
        });
      };

      return (
        <div className="min-h-screen bg-gray-50">
          <header className="bg-white border-b sticky top-0 z-50 no-print">
            <div className="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <div className="w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center">
                  <svg className="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                </div>
                <h1 className="text-lg font-bold text-gray-800">Profile Builder Pro</h1>
              </div>
              {profile && (
                <div className="flex gap-2">
                  <button onClick={handleExportDOCX} disabled={exporting} className="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50">
                    Download DOCX
                  </button>
                  <button onClick={handleExportPDF} disabled={exporting} className="px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50">
                    Download PDF
                  </button>
                </div>
              )}
            </div>
          </header>

          <main className="max-w-7xl mx-auto px-6 py-6">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div className="space-y-4 no-print">
                {/* Company Branding */}
                <div className="bg-white rounded-xl border p-4">
                  <h2 className="text-sm font-semibold mb-3">Company Branding</h2>
                  <div className="space-y-3">
                    <input type="text" value={companyName} onChange={(e) => setCompanyName(e.target.value)} placeholder="Your Staffing Agency Name" className="w-full px-3 py-2 border rounded-lg text-base" />
                    <div className="flex items-center gap-3">
                      <input type="file" ref={logoRef} onChange={handleLogoUpload} accept="image/*" className="hidden" />
                      <button onClick={() => logoRef.current?.click()} className="px-4 py-2 border rounded-lg text-sm hover:bg-gray-50">
                        {companyLogo ? 'Change Logo' : 'Upload Logo'}
                      </button>
                      {companyLogo && (
                        <>
                          <img src={companyLogo} alt="Logo" className="h-12 object-contain" />
                          <button onClick={() => setCompanyLogo(null)} className="text-red-500 text-sm">Remove</button>
                        </>
                      )}
                    </div>
                  </div>
                </div>

                {/* Resume Upload */}
                <div className="bg-white rounded-xl border p-4">
                  <h2 className="text-sm font-semibold mb-3">Upload Resume</h2>
                  <div onClick={() => fileRef.current?.click()} className="border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition mb-3">
                    <input type="file" ref={fileRef} onChange={(e) => handleFile(e.target.files[0])} accept=".pdf,.docx,.doc,.txt" className="hidden" />
                    {fileLoading ? (
                      <div className="text-blue-600">Extracting text...</div>
                    ) : fileName ? (
                      <div>
                        <div className="text-green-600 font-medium">{fileName}</div>
                        <button onClick={(e) => { e.stopPropagation(); setFileName(''); setResumeText(''); }} className="text-xs text-red-500 mt-1">Remove</button>
                      </div>
                    ) : (
                      <div className="text-gray-500">Drop PDF, DOCX, or TXT here</div>
                    )}
                  </div>
                  <textarea value={resumeText} onChange={(e) => { setResumeText(e.target.value); setFileName(''); }} placeholder="Or paste resume text..." className="w-full h-32 px-3 py-2 border rounded-lg text-sm resize-none" />
                  {error && <div className="mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-sm">{error}</div>}
                  <button onClick={handleExtract} disabled={loading || fileLoading} className="mt-3 w-full py-2.5 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:opacity-50">
                    {loading ? 'Processing...' : 'Extract & Build Profile'}
                  </button>
                </div>

                {/* Additional Info */}
                {profile && (
                  <div className="bg-white rounded-xl border p-4">
                    <h2 className="text-sm font-semibold mb-3">Additional Information</h2>
                    <div className="grid grid-cols-2 gap-3 mb-3">
                      <input type="url" value={additional.nursysLink} onChange={(e) => setAdditional(prev => ({ ...prev, nursysLink: e.target.value }))} placeholder="Nursys Link" className="px-3 py-2 border rounded-lg text-sm" />
                      <div className="flex gap-2">
                        <input type="text" value={additional.driversLicense.state} onChange={(e) => setAdditional(prev => ({ ...prev, driversLicense: { ...prev.driversLicense, state: e.target.value }}))} placeholder="DL State" className="w-20 px-2 py-2 border rounded-lg text-sm" />
                        <input type="text" value={additional.driversLicense.expiration} onChange={(e) => setAdditional(prev => ({ ...prev, driversLicense: { ...prev.driversLicense, expiration: e.target.value }}))} placeholder="DL Exp" className="flex-1 px-2 py-2 border rounded-lg text-sm" />
                      </div>
                    </div>
                    <div className="text-xs font-medium text-gray-500 mb-2">References</div>
                    {additional.references.map((ref, i) => (
                      <div key={i} className="grid grid-cols-5 gap-2 mb-2">
                        <input type="text" value={ref.name} onChange={(e) => updateRef(i, 'name', e.target.value)} placeholder="Name" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.title} onChange={(e) => updateRef(i, 'title', e.target.value)} placeholder="Title" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.phone} onChange={(e) => updateRef(i, 'phone', e.target.value)} placeholder="Phone" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.email} onChange={(e) => updateRef(i, 'email', e.target.value)} placeholder="Email" className="px-2 py-1 border rounded text-xs" />
                        <input type="text" value={ref.relationship} onChange={(e) => updateRef(i, 'relationship', e.target.value)} placeholder="Relation" className="px-2 py-1 border rounded text-xs" />
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Profile Display */}
              <div>
                {profile ? (
                  <div ref={profileRef}>
                    <ProfileDisplay data={profile} companyName={companyName} companyLogo={companyLogo} additional={additional} />
                  </div>
                ) : (
                  <div className="bg-white rounded-xl border p-12 text-center">
                    <div className="text-gray-400">Upload a resume to generate profile</div>
                  </div>
                )}
              </div>
            </div>
          </main>
        </div>
      );
    }

    function ProfileDisplay({ data, companyName, companyLogo, additional }) {
      const { personalInfo, licenses, certifications, education, workHistory, yearsExperience, primarySpecialty } = data;
      const licenseStates = licenses?.map(l => l.state).filter(Boolean).join(', ') || 'N/A';
      const hasCompact = licenses?.some(l => l.compact);

      return (
        <div className="bg-white rounded-xl border overflow-hidden">
          {/* Company Header - MUCH BIGGER */}
          {(companyLogo || companyName) && (
            <div className="px-6 py-5 bg-slate-50 border-b">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  {companyLogo && <img src={companyLogo} alt="Logo" className="h-14 w-auto object-contain" />}
                  {companyName && <span className="font-bold text-slate-800 text-2xl">{companyName}</span>}
                </div>
                <span className="text-sm text-slate-500 font-medium">Candidate Profile</span>
              </div>
            </div>
          )}

          {/* Blue Highlight Box */}
          <div className="highlight-box text-white p-5">
            <div className="flex justify-between items-start mb-4">
              <div>
                <h1 className="text-2xl font-bold">{personalInfo?.fullName || 'Candidate Name'}</h1>
                <p className="text-blue-100 text-sm mt-1">
                  {[personalInfo?.email, personalInfo?.phone, personalInfo?.location].filter(Boolean).join(' ‚Ä¢ ') || 'Contact info not provided'}
                </p>
              </div>
              <span className="bg-white/20 px-3 py-1 rounded-full text-sm font-semibold">{primarySpecialty || 'RN'}</span>
            </div>

            <div className="grid grid-cols-4 gap-3">
              <div className="bg-white/15 rounded-lg p-3 text-center">
                <div className="text-2xl font-bold">{yearsExperience || '‚Äî'}</div>
                <div className="text-xs text-blue-100">Years Exp</div>
              </div>
              <div className="bg-white/15 rounded-lg p-3 text-center">
                <div className="text-lg font-bold">{licenseStates}</div>
                <div className="text-xs text-blue-100">{hasCompact ? 'Compact' : 'Licensed'}</div>
              </div>
              <div className="bg-white/15 rounded-lg p-3 text-center">
                <div className="text-2xl font-bold">{certifications?.length || 0}</div>
                <div className="text-xs text-blue-100">Certs</div>
              </div>
              <div className="bg-white/15 rounded-lg p-3 text-center">
                <div className="text-2xl font-bold">{workHistory?.length || 0}</div>
                <div className="text-xs text-blue-100">Positions</div>
              </div>
            </div>

            {certifications?.length > 0 && (
              <div className="flex flex-wrap gap-2 mt-4">
                {certifications.map((cert, i) => (
                  <span key={i} className="bg-white/20 px-3 py-1 rounded-full text-sm font-medium">{cert}</span>
                ))}
              </div>
            )}
          </div>

          {/* Credentials Section */}
          <div className="px-6 py-5 border-b">
            <h2 className="text-lg font-bold text-slate-800 mb-4">Credentials & Education</h2>
            <div className="grid grid-cols-3 gap-6">
              <div>
                <div className="font-semibold text-slate-500 uppercase text-xs mb-2 tracking-wide">Licenses</div>
                {licenses?.length > 0 ? licenses.map((lic, i) => (
                  <div key={i} className="flex items-center gap-2 mb-2">
                    <span className="w-9 h-9 bg-emerald-100 text-emerald-700 rounded-lg flex items-center justify-center font-bold text-sm">{lic.state || '??'}</span>
                    <span className="text-sm">{lic.type || 'RN'}{lic.compact && <span className="text-emerald-600 ml-1 text-xs font-medium">(Compact)</span>}</span>
                  </div>
                )) : <div className="text-slate-400 text-sm">Not specified</div>}
                {additional?.nursysLink && (
                  <a href={additional.nursysLink} target="_blank" rel="noopener noreferrer" className="text-blue-600 text-xs mt-2 block hover:underline">Nursys Verification ‚Üí</a>
                )}
              </div>
              <div>
                <div className="font-semibold text-slate-500 uppercase text-xs mb-2 tracking-wide">Certifications</div>
                {certifications?.length > 0 ? (
                  <div className="flex flex-wrap gap-1.5">
                    {certifications.map((cert, i) => (
                      <span key={i} className="bg-slate-100 text-slate-700 px-2 py-1 rounded text-xs font-medium">{cert}</span>
                    ))}
                  </div>
                ) : <div className="text-slate-400 text-sm">Not specified</div>}
              </div>
              <div>
                <div className="font-semibold text-slate-500 uppercase text-xs mb-2 tracking-wide">Education</div>
                {education ? (
                  <div>
                    <div className="font-semibold text-slate-800">{education.degree}</div>
                    <div className="text-slate-600 text-sm">{education.school}</div>
                    <div className="text-slate-500 text-xs">{education.graduationDate}</div>
                  </div>
                ) : <div className="text-slate-400 text-sm">Not specified</div>}
                {additional?.driversLicense?.state && (
                  <div className="mt-3 pt-3 border-t text-sm">
                    <span className="text-slate-500">DL:</span> {additional.driversLicense.state} (Exp: {additional.driversLicense.expiration || 'N/A'})
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Work History */}
          <div className="px-6 py-5">
            <h2 className="text-lg font-bold text-slate-800 mb-4">Work History</h2>
            <div className="space-y-4">
              {workHistory?.length > 0 ? workHistory.map((job, i) => (
                <div key={i} className="border rounded-xl overflow-hidden">
                  <div className="bg-slate-50 px-4 py-3 border-b flex justify-between items-start">
                    <div>
                      <div className="font-bold text-slate-800 text-base">{job.title}</div>
                      <div className="text-slate-600 text-sm">{job.facility} ‚Ä¢ {job.city}, {job.state}</div>
                    </div>
                    <div className="text-right">
                      <div className="text-slate-500 text-xs">{job.startDate} - {job.endDate}</div>
                      {job.unit && <span className="inline-block mt-1 bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-medium">{job.unit}</span>}
                    </div>
                  </div>
                  <div className="px-4 py-3">
                    {job.hospitalData && (
                      <div className="mb-3 p-2.5 bg-amber-50 border border-amber-200 rounded-lg text-sm">
                        <span className="font-semibold text-amber-800">Facility Info: </span>
                        <span className="text-amber-700">{job.hospitalData.beds} beds | {job.hospitalData.trauma} | {job.hospitalData.teaching ? 'Teaching' : 'Non-Teaching'} | {job.hospitalData.emr} EMR</span>
                      </div>
                    )}
                    {job.responsibilities?.length > 0 ? (
                      <ul className="space-y-1.5">
                        {job.responsibilities.map((resp, j) => (
                          <li key={j} className="flex gap-2 text-sm text-slate-700">
                            <span className="text-blue-500 mt-0.5">‚Ä¢</span>
                            <span>{resp}</span>
                          </li>
                        ))}
                      </ul>
                    ) : (
                      <div className="text-slate-400 text-sm italic">No responsibilities listed</div>
                    )}
                    {job.chargeExperience && (
                      <div className="mt-3">
                        <span className="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-xs font-semibold">‚≠ê Charge Nurse Experience</span>
                      </div>
                    )}
                  </div>
                </div>
              )) : <div className="text-slate-400">No work history found</div>}
            </div>
          </div>

          {/* References */}
          {additional?.references?.some(r => r.name) && (
            <div className="px-6 py-5 bg-slate-50 border-t">
              <h2 className="text-lg font-bold text-slate-800 mb-4">Professional References</h2>
              <div className="grid grid-cols-3 gap-3">
                {additional.references.filter(r => r.name).map((ref, i) => (
                  <div key={i} className="bg-white p-3 rounded-lg border">
                    <div className="font-semibold text-slate-800">{ref.name}</div>
                    {ref.title && <div className="text-slate-600 text-sm">{ref.title}</div>}
                    {ref.relationship && <div className="text-slate-500 text-xs">{ref.relationship}</div>}
                    {ref.phone && <div className="text-sm mt-1">{ref.phone}</div>}
                    {ref.email && <div className="text-blue-600 text-sm">{ref.email}</div>}
                  </div>
                ))}
              </div>
            </div>
          )}

          <div className="px-6 py-3 bg-slate-50 border-t text-center">
            <p className="text-xs text-slate-400">Profile Builder Pro ‚Ä¢ {new Date().toLocaleDateString()}</p>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
